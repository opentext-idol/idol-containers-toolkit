// patching config file
// idol_ssl.cfg is written by run_idol.sh with SSL settings if required by IDOL_SSL env variable
// original.statsserver.cfg is the config file as contained in the standard component zip

// modified config sections

< "idol_ssl.cfg" [SSLSettings]

[License] < "original.statsserver.cfg" [License]
LicenseServerHost={{ .Values.licenseServerHostname }}
LicenseServerACIPort={{ .Values.licenseServerPort | int }}
SSLConfig=License
SSLMethod={{ default "None" .Values.licenseServerSSLMethod }}

[Service] < "original.statsserver.cfg" [Service]
Access-Control-Allow-Origin=*
ServicePort={{ .Values.servicePort | int }}

[Server] < "original.statsserver.cfg" [Server]
< "idol_ssl.cfg" [EnableSSL] SSLConfig
Port={{ .Values.aciPort | int }}
EventPort={{ .Values.eventPort | int }}

[AuthorizationRoles] < "original.statsserver.cfg" [AuthorizationRoles]

[AdminRole] < "original.statsserver.cfg" [AdminRole]
Clients=*

[QueryRole] < "original.statsserver.cfg" [QueryRole]
Clients=*

[Logging] < "original.statsserver.cfg" [Logging]
LogDirectory=/idol-logs
LogArchiveDirectory=/idol-logs/archive
LogEcho=TRUE

[IDOLStatistics]
EventField=queryinfo/idolname
Number=2

[Statistics]
0=ContentQueryTenMinuteCount
1=ContentQueryHourlyCount
2=ContentQueryDailyCount
3=ContentQueryHourlyTop10Terms
4=ContentQueryDailyTop10Terms
5=ContentQueryWeeklyTop10Terms
6=ContentZeroHitTenMinuteCount
7=ContentZeroHitQueryHourlyCount
8=ContentZeroHitQueryDailyCount
9=ContentZeroHitQueryWeeklyTop10Terms
10=QmsRulesHourlyTop100000
11=QmsRulesDailyTop100000
12=QmsRulesWeeklyTop100000

[ContentQueryTenMinuteCount]
IDOLName=content
Operation=count
Field=queryinfo/action
AEqualStat=action,query
Period=600

[ContentQueryHourlyCount]
IDOLName=content
Operation=count
Field=queryinfo/action
AEqualStat=action,query
Period=3600

[ContentQueryDailyCount]
IDOLName=content
Operation=count
Field=queryinfo/action
AEqualStat=action,query
Period=86400

[ContentQueryHourlyTop10Terms]
IDOLName=content
Operation=topn,10
Field=queryinfo/terms/term
AEqualStat=action,query
Period=3600

[ContentQueryDailyTop10Terms]
IDOLName=content
Operation=topn,10
Field=queryinfo/terms/term
AEqualStat=action,query
Period=86400

[ContentQueryWeeklyTop10Terms]
IDOLName=content
Operation=topn,10
Field=queryinfo/terms/term
AEqualStat=action,query
Period=604800
Offset=2014/11/03 00:00:00

[ContentZeroHitTenMinuteCount]
IDOLName=content
Operation=count
Field=queryinfo/numhits
NEqualStat=queryinfo/numhits,0
AEqualStat=action,query
Period=600

[ContentZeroHitQueryHourlyCount]
IDOLName=content
Operation=count
Field=queryinfo/numhits
NEqualStat=queryinfo/numhits,0
AEqualStat=action,query
Period=3600

[ContentZeroHitQueryDailyCount]
IDOLName=content
Operation=count
Field=queryinfo/numhits
NEqualStat=queryinfo/numhits,0
AEqualStat=action,query
Period=86400

[ContentZeroHitQueryWeeklyTop10Terms]
IDOLName=content
Operation=topn,10
Field=queryinfo/terms/term
NEqualStat=queryinfo/numhits,0
AEqualStat=action,query
Period=604800
Offset=2014/11/03 00:00:00

[QmsRulesHourlyTop100000]
IDOLName=qms
Operation=topn,100000
Field=queryinfo/results/reference
Period=3600
Offset=2014/11/03 00:00:00

[QmsRulesDailyTop100000]
IDOLName=qms
Operation=topn,100000
Field=queryinfo/results/reference
Period=86400
Offset=2014/11/03 00:00:00

[QmsRulesWeeklyTop100000]
IDOLName=qms
Operation=topn,100000
Field=queryinfo/results/reference
Period=604800
Offset=2014/11/03 00:00:00
